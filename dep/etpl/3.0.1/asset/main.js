/*! 2016 Baidu Inc. All Rights Reserved */
!function(e){function n(e,n){for(var t in n)if(n.hasOwnProperty(t))e[t]=n[t];return e}function t(){this.raw=[],this.length=0}function i(){return"___"+k++}function a(e,n){var t=new Function;t.prototype=n.prototype,e.prototype=new t,e.prototype.constructor=e}function r(e){return $[e]}function o(e){return'"'+e.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function s(e){return e.replace(/[\^\[\]\$\(\)\{\}\?\*\.\+]/g,function(e){return"\\"+e})}function l(e){var n=arguments;return e.replace(/\{([0-9]+)\}/g,function(e,t){return n[t-0+1]})}function c(e){return e=e.replace(/^\s*\*/,""),l('gv({0},["{1}"])',o(e),e.replace(/\[['"]?([^'"]+)['"]?\]/g,function(e,n){return"."+n}).split(".").join('","'))}function d(e,n,t,i,a,r){for(var o=t.length,s=e.split(n),l=0,c=[],d=0,f=s.length;f>d;d++){var h=s[d];if(d){var u=1;for(l++;;){var p=h.indexOf(t);if(0>p){c.push(l>1&&u?n:"",h);break}if(l=i?l-1:0,c.push(l>0&&u?n:"",h.slice(0,p),l>0?t:""),h=h.slice(p+o),u=0,0===l)break}if(0===l)a(c.join("")),r(h),c=[]}else h&&r(h)}if(l>0&&c.length>0)r(n),r(c.join(""))}function f(e,n,t){var i,a=[],r=n.options,s="",l="",h="",u="";if(t)s="ts(",l=")",h=H,u=T,i=r.defaultFilter;return d(e,r.variableOpen,r.variableClose,1,function(e){if(t&&e.indexOf("|")<0&&i)e+="|"+i;var r=e.indexOf("|"),o=(r>0?e.slice(0,r):e).replace(/^\s+/,"").replace(/\s+$/,""),d=r>0?e.slice(r+1):"",p=0===o.indexOf("*"),m=[p?"":s,c(o),p?"":l];if(d){d=f(d,n);for(var g=d.split("|"),v=0,y=g.length;y>v;v++){var b=g[v];if(/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test(b)){if(m.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3)m.push(",",RegExp.$3);m.push(")")}}}a.push(h,m.join(""),u)},function(e){a.push(h,t?o(e):e,u)}),a.join("")}function h(e,n){this.value=e,this.engine=n}function u(e,n){this.value=e,this.engine=n,this.children=[],this.cloneProps=[]}function p(e,n){var t=e.stack,i=n?t.find(function(e){return e instanceof n}):t.bottom();if(i){for(var a;(a=t.top())!==i;){if(!a.autoClose)throw new Error(a.type+" must be closed manually: "+a.value);a.autoClose(e)}i.close(e)}return i}function m(e,n){if(!/^\s*([a-z0-9\/_-]+)\s*(\(\s*master\s*=\s*([a-z0-9\/_-]+)\s*\))?\s*/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.master=RegExp.$3,this.name=RegExp.$1,u.call(this,e,n),this.blocks={}}function g(e,n){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,u.call(this,e,n),this.cloneProps=["name"]}function v(e,n){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,u.call(this,e,n),this.cloneProps=["name","state","blocks"],this.blocks={}}function y(e,n){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.expr=RegExp.$2,u.call(this,e,n),this.cloneProps=["name","expr"]}function b(e,n){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,u.call(this,e,n),this.cloneProps=["name","args"]}function w(e,n){if(!/^\s*([a-z0-9\/_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,u.call(this,e,n),this.cloneProps=["name","args"]}function M(e,n){var t=new RegExp(l("^\\s*({0}[\\s\\S]+{1})\\s+as\\s+{0}([0-9a-z_]+){1}\\s*(,\\s*{0}([0-9a-z_]+){1})?\\s*$",s(n.options.variableOpen),s(n.options.variableClose)),"i");if(!t.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,u.call(this,e,n),this.cloneProps=["list","item","index"]}function R(e,n){u.call(this,e,n)}function C(e,n){R.call(this,e,n)}function x(e,n){u.call(this,e,n)}function E(e,n){n.target=e;var t=n.engine,i=e.name;if(t.targets[i])switch(t.options.namingConflict){case"override":t.targets[i]=e,n.targets.push(i);case"ignore":break;default:throw new Error("Target exists: "+i)}else t.targets[i]=e,n.targets.push(i)}function D(e,n){_[e]=n,n.prototype.type=e}function S(e){this.options={commandOpen:"<!--",commandClose:"-->",commandSyntax:/^\s*(\/)?([a-z]+)\s*(?::([\s\S]*))?$/,variableOpen:"${",variableClose:"}",defaultFilter:"html"},this.config(e),this.targets={},this.filters=n({},O)}function P(e,n){function i(){var e;if(f.length>0&&(e=f.join(""))){var t=new h(e,n);if(t.beforeAdd(c),l.top().addChild(t),f=[],n.options.strip&&c.current instanceof u)t.value=e.replace(/^[\x20\t\r]*\n/,"");c.current=t}}var a,r=n.options.commandOpen,o=n.options.commandClose,s=n.options.commandSyntax,l=new t,c={engine:n,targets:[],stack:l,target:null},f=[];return d(e,r,o,0,function(e){var t=s.exec(e);if(t&&(a=_[t[2].toLowerCase()])&&"function"==typeof a){i();var l=c.current;if(n.options.strip&&l instanceof h)l.value=l.value.replace(/\r?\n[\x20\t]*$/,"\n");if(t[1])l=p(c,a);else{if(l=new a(t[3],n),"function"==typeof l.beforeOpen)l.beforeOpen(c);l.open(c)}c.current=l}else if(!/^\s*\/\//.test(e))f.push(r,e,o);a=null},function(e){f.push(e)}),i(),p(c),c.targets}t.prototype={push:function(e){this.raw[this.length++]=e},pop:function(){if(this.length>0){var e=this.raw[--this.length];return this.raw.length=this.length,e}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(e){for(var n=this.length;n--;){var t=this.raw[n];if(e(t))return t}}};var k=178245,$={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},O={html:function(e){return e.replace(/[&<>"']/g,r)},url:encodeURIComponent,raw:function(e){return e}},j='var r="";',H="r+=",T=";",A="return r;";if("undefined"!=typeof navigator&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8)j="var r=[],ri=0;",H="r[ri++]=",A='return r.join("");';h.prototype={getRendererBody:function(){var e=this.value,n=this.engine.options;if(!e||n.strip&&/^\s*$/.test(e))return"";else return f(e,this.engine,1)},clone:function(){return this}},u.prototype={addChild:function(e){this.children.push(e)},open:function(e){var n=e.stack.top();n&&n.addChild(this),e.stack.push(this)},close:function(e){if(e.stack.top()===this)e.stack.pop()},getRendererBody:function(){for(var e=[],n=this.children,t=0;t<n.length;t++)e.push(n[t].getRendererBody());return e.join("")},clone:function(){for(var e=this.constructor,n=new e(this.value,this.engine),t=0,i=this.children.length;i>t;t++)n.addChild(this.children[t].clone());for(var t=0,i=this.cloneProps.length;i>t;t++){var a=this.cloneProps[t];n[a]=this[a]}return n}};var I='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';a(m,u),a(g,u),a(v,u),a(y,u),a(b,u),a(w,u),a(M,u),a(R,u),a(C,R),a(x,R);var q={READING:1,READED:2,APPLIED:3,READY:4};v.prototype.applyMaster=m.prototype.applyMaster=function(e){function n(e){var i=e.children;if(i instanceof Array)for(var a=0,r=i.length;r>a;a++){var o=i[a];if(o instanceof g&&t[o.name])o=i[a]=t[o.name];n(o)}}if(this.state>=q.APPLIED)return 1;var t=this.blocks,i=this.engine.targets[e];if(i&&i.applyMaster(i.master))return this.children=i.clone().children,n(this),this.state=q.APPLIED,1;else return void 0},m.prototype.isReady=function(){function e(i){for(var a=0,r=i.children.length;r>a;a++){var o=i.children[a];if(o instanceof v){var s=n.targets[o.name];t=t&&s&&s.isReady(n)}else if(o instanceof u)e(o)}}if(this.state>=q.READY)return 1;var n=this.engine,t=1;if(this.applyMaster(this.master))return e(this),t&&(this.state=q.READY),t;else return void 0},m.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var e=new Function("data","engine",[I,j,this.getRendererBody(),A].join("\n")),n=this.engine;return this.renderer=function(t){return e(t,n)},this.renderer}return null},m.prototype.open=function(e){p(e),u.prototype.open.call(this,e),this.state=q.READING,E(this,e)},y.prototype.open=w.prototype.open=function(e){e.stack.top().addChild(this)},g.prototype.open=function(e){u.prototype.open.call(this,e),e.stack.find(function(e){return e.blocks}).blocks[this.name]=this},C.prototype.open=function(e){var n=new x;n.open(e);var t=p(e,R);t.addChild(this),e.stack.push(this)},x.prototype.open=function(e){var n=p(e,R);n.addChild(this),e.stack.push(this)},v.prototype.open=function(e){this.parent=e.stack.top(),this.target=e.target,u.prototype.open.call(this,e),this.state=q.READING},w.prototype.close=y.prototype.close=function(){},v.prototype.close=function(e){u.prototype.close.call(this,e),this.state=q.READED},m.prototype.close=function(e){u.prototype.close.call(this,e),this.state=this.master?q.READED:q.APPLIED,e.target=null},v.prototype.autoClose=function(e){var n=this.parent.children;n.push.apply(n,this.children),this.children.length=0;for(var t in this.blocks)this.target.blocks[t]=this.blocks[t];this.blocks={},this.close(e)},w.prototype.beforeOpen=v.prototype.beforeOpen=y.prototype.beforeOpen=M.prototype.beforeOpen=b.prototype.beforeOpen=g.prototype.beforeOpen=R.prototype.beforeOpen=h.prototype.beforeAdd=function(e){if(!e.stack.bottom()){var n=new m(i(),e.engine);n.open(e)}},v.prototype.getRendererBody=function(){return this.applyMaster(this.name),u.prototype.getRendererBody.call(this)},w.prototype.getRendererBody=function(){return l("{0}engine.render({2},{{3}}){1}",H,T,o(this.name),f(this.args,this.engine).replace(/(^|,)\s*([a-z0-9_]+)\s*=/gi,function(e,n,t){return(n||"")+o(t)+":"}))},y.prototype.getRendererBody=function(){if(this.expr)return l("v[{0}]={1};",o(this.name),f(this.expr,this.engine));else return""},R.prototype.getRendererBody=function(){return l("if({0}){{1}}",f(this.value,this.engine),u.prototype.getRendererBody.call(this))},x.prototype.getRendererBody=function(){return l("}else{{0}",u.prototype.getRendererBody.call(this))},M.prototype.getRendererBody=function(){return l('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',i(),f(this.list,this.engine),o(this.index||i()),o(this.item),i(),i(),u.prototype.getRendererBody.call(this))},b.prototype.getRendererBody=function(){var e=this.args;return l("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",j,A,H,T,u.prototype.getRendererBody.call(this),o(this.name),e?","+f(e,this.engine):"")};var _={};D("target",m),D("block",g),D("import",v),D("use",w),D("var",y),D("for",M),D("if",R),D("elif",C),D("else",x),D("filter",b),S.prototype.config=function(e){n(this.options,e)},S.prototype.compile=S.prototype.parse=function(e){if(e){var n=P(e,this);if(n.length)return this.targets[n[0]].getRenderer()}return new Function('return ""')},S.prototype.getRenderer=function(e){var n=this.targets[e];if(n)return n.getRenderer();else return void 0},S.prototype.render=function(e,n){var t=this.getRenderer(e);if(t)return t(n);else return""},S.prototype.addFilter=function(e,n){if("function"==typeof n)this.filters[e]=n};var F=new S;if(F.Engine=S,"object"==typeof exports&&"object"==typeof module)exports=module.exports=F;else if("function"==typeof define&&define.amd)define("etpl/main",[],F);else e.etpl=F}(this),define("etpl",["etpl/main"],function(e){return e});